{"ast":null,"code":"var Marker = require('../tokenizer/marker');\n\nfunction split(value, separator) {\n  var openLevel = Marker.OPEN_ROUND_BRACKET;\n  var closeLevel = Marker.CLOSE_ROUND_BRACKET;\n  var level = 0;\n  var cursor = 0;\n  var lastStart = 0;\n  var lastValue;\n  var lastCharacter;\n  var len = value.length;\n  var parts = [];\n\n  if (value.indexOf(separator) == -1) {\n    return [value];\n  }\n\n  if (value.indexOf(openLevel) == -1) {\n    return value.split(separator);\n  }\n\n  while (cursor < len) {\n    if (value[cursor] == openLevel) {\n      level++;\n    } else if (value[cursor] == closeLevel) {\n      level--;\n    }\n\n    if (level === 0 && cursor > 0 && cursor + 1 < len && value[cursor] == separator) {\n      parts.push(value.substring(lastStart, cursor));\n      lastStart = cursor + 1;\n    }\n\n    cursor++;\n  }\n\n  if (lastStart < cursor + 1) {\n    lastValue = value.substring(lastStart);\n    lastCharacter = lastValue[lastValue.length - 1];\n\n    if (lastCharacter == separator) {\n      lastValue = lastValue.substring(0, lastValue.length - 1);\n    }\n\n    parts.push(lastValue);\n  }\n\n  return parts;\n}\n\nmodule.exports = split;","map":null,"metadata":{},"sourceType":"script"}