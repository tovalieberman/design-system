{"ast":null,"code":"\"use strict\";\n\nfunction isDirectoryIndex(resource, options) {\n  var verdict = false;\n  options.directoryIndexes.every(function (index) {\n    if (index === resource) {\n      verdict = true;\n      return false;\n    }\n\n    return true;\n  });\n  return verdict;\n}\n\nfunction parsePath(urlObj, options) {\n  var path = urlObj.path.absolute.string;\n\n  if (path) {\n    var lastSlash = path.lastIndexOf(\"/\");\n\n    if (lastSlash > -1) {\n      if (++lastSlash < path.length) {\n        var resource = path.substr(lastSlash);\n\n        if (resource !== \".\" && resource !== \"..\") {\n          urlObj.resource = resource;\n          path = path.substr(0, lastSlash);\n        } else {\n          path += \"/\";\n        }\n      }\n\n      urlObj.path.absolute.string = path;\n      urlObj.path.absolute.array = splitPath(path);\n    } else if (path === \".\" || path === \"..\") {\n      // \"..?var\", \"..#anchor\", etc ... not \"..index.html\"\n      path += \"/\";\n      urlObj.path.absolute.string = path;\n      urlObj.path.absolute.array = splitPath(path);\n    } else {\n      // Resource-only\n      urlObj.resource = path;\n      urlObj.path.absolute.string = null;\n    }\n\n    urlObj.extra.resourceIsIndex = isDirectoryIndex(urlObj.resource, options);\n  } // Else: query/hash-only or empty\n\n}\n\nfunction splitPath(path) {\n  // TWEAK :: condition only for speed optimization\n  if (path !== \"/\") {\n    var cleaned = [];\n    path.split(\"/\").forEach(function (dir) {\n      // Cleanup -- splitting \"/dir/\" becomes [\"\",\"dir\",\"\"]\n      if (dir !== \"\") {\n        cleaned.push(dir);\n      }\n    });\n    return cleaned;\n  } else {\n    // Faster to skip the above block and just create an array\n    return [];\n  }\n}\n\nmodule.exports = parsePath;","map":null,"metadata":{},"sourceType":"script"}